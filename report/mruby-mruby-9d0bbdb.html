<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    <title>mruby build & test report</title>
    <style>
      pre {
        white-space: -moz-pre-wrap; /* Mozilla */
        white-space: -pre-wrap;     /* Opera 4-6 */
        white-space: -o-pre-wrap;   /* Opera 7 */
        white-space: pre-wrap;      /* CSS3 */
        word-wrap: break-word;      /* IE 5.5+ */
      }
      textarea {
        width: 100%;
        height: 400px;
        font-family: monospace !important;
        font-size: 12px !important;
      }
    </style>
  </head>
  <body>
    <a name="top"></a>
    <div style="background-color:#a0a0a0;">
      
        
        <a href="iij-mruby.html">iij-mruby</a>
      
        
        <a href="mruby-mruby.html">mruby-mruby</a>
      
    </div>

    
    

    <h1>mruby build & test report
      <span style="font-size:small;">(mruby/mruby - 9d0bbdb)</span>
    </h1>

    <ul>
      <li><a href="http://github.com/mruby/mruby/commit/9d0bbdb" target="_blank">commit info on github</a></li>
      
      
        
        
        
          <li><a href="mruby-mruby.html">back to mruby-mruby</a></li>
        
      
      <li>
      <pre>commit 9d0bbdb7f8b54631d639d3ed3038b6546ee4558d
Author: Yukihiro Matz Matsumoto &lt;matz@ruby-lang.org&gt;
Date:   Thu Mar 14 19:33:38 2013 +0900

    use size_t for string length C API

</pre>
      <a href="#commitlog">commit log</a>
      </li>
  </ul>

    <h2>mrbtest</h2>
    
    <table border="1">
      <tr>
        
          <th rowspan="2">Name</th>
        
          <th rowspan="2">Build-Status</th>
        
          <th rowspan="2">Mrbtest-Status</th>
        
          <th rowspan="2">Total</th>
        
          <th rowspan="2">OK</th>
        
          <th rowspan="2">KO</th>
        
          <th rowspan="2">Crash</th>
        
          <th rowspan="2">Fail</th>
        
          <th rowspan="2">Msg</th>
        
        <th colspan="2">FileSize (Byte)</th>
      </tr>
      <tr>
        
          <th>bin/mruby</th>
        
          <th>lib/libmruby.a</th>
        
      </tr>
      
        
        
        <tr style="background-color:#99ff99">
          <td><a href="#netbsd_arm_nb6">netbsd_arm_nb6</a></td>
          <td>success</td>
          <td>success</td>
          <td>533</td>
          <td>533</td>
          <td>0</td>
          <td>0</td>
          <td></td>
          <td></td>
          
            <td style="text-align:right;">440,336</td>
          
            <td style="text-align:right;">464,384</td>
          
        </tr>
      
    </table>

    

    <h2>environment <span style="font-size:small;"><a href="#top">#top</a></span></h2>
    <table border='1'>
      <tr>
        <th>Name</th>
        <th>software version</th>
      </tr>
      
        
        <tr>
          <td rowspan="3">netbsd_arm_nb6</td>
          <td><b>gcc</b><br/><pre></pre></td>
        </tr>
        <tr><td><b>make</b><br/><pre></pre></td></tr>
        <tr><td><b>bison</b><br/><pre></pre></td></tr>
      
    </table>

    <h2>Build Log</h2>
    
      
      <h3><a name="netbsd_arm_nb6">netbsd_arm_nb6</a> <span style="font-size:small;"><a href="#top">#top</a></span></h3>
      <table border='1' style="width:90%;">
        <tr>
          <th style="width:100px;">task</th>
          <th>stdout</th>
          <th>stderr</th>
        </tr>
        <tr>
          <th>make</th>
          <td><textarea>(in /home/mruby/arm-nb6/mruby-mruby-9d0bbdb)
CC    tools/mruby/mruby.c -> build/host/tools/mruby/mruby.o
CC    src/range.c -> build/host/src/range.o
CC    src/array.c -> build/host/src/array.o
CC    src/numeric.c -> build/host/src/numeric.o
CC    src/pool.c -> build/host/src/pool.o
CC    src/compar.c -> build/host/src/compar.o
CC    src/crc.c -> build/host/src/crc.o
CC    src/proc.c -> build/host/src/proc.o
CC    src/state.c -> build/host/src/state.o
CC    src/print.c -> build/host/src/print.o
CC    src/vm.c -> build/host/src/vm.o
CC    src/class.c -> build/host/src/class.o
CC    src/load.c -> build/host/src/load.o
CC    src/codegen.c -> build/host/src/codegen.o
CC    src/symbol.c -> build/host/src/symbol.o
CC    src/etc.c -> build/host/src/etc.o
CC    src/gc.c -> build/host/src/gc.o
CC    src/init.c -> build/host/src/init.o
CC    src/dump.c -> build/host/src/dump.o
CC    src/kernel.c -> build/host/src/kernel.o
CC    src/hash.c -> build/host/src/hash.o
CC    src/string.c -> build/host/src/string.o
CC    src/variable.c -> build/host/src/variable.o
CC    src/object.c -> build/host/src/object.o
CC    src/enum.c -> build/host/src/enum.o
CC    src/error.c -> build/host/src/error.o
YACC  src/parse.y -> build/host/src/y.tab.c
CC    build/host/src/y.tab.c -> build/host/src/y.tab.o
CC    tools/mrbc/mrbc.c -> build/host/tools/mrbc/mrbc.o
AR    build/host/lib/libmruby_core.a 
LD    build/host/bin/mrbc 
GEN   *.rb -> build/host/mrblib/mrblib.c
      MRBC mrblib/kernel.rb 
      MRBC mrblib/compar.rb 
      MRBC mrblib/hash.rb 
      MRBC mrblib/numeric.rb 
      MRBC mrblib/class.rb 
      MRBC mrblib/string.rb 
      MRBC mrblib/enum.rb 
      MRBC mrblib/print.rb 
      MRBC mrblib/array.rb 
      MRBC mrblib/range.rb 
      MRBC mrblib/error.rb 
CC    build/host/mrblib/mrblib.c -> build/host/mrblib/mrblib.o
CC    mrbgems/mruby-math/src/math.c -> build/host/mrbgems/mruby-math/src/math.o
CC    build/host/mrbgems/mruby-math/gem_init.c -> build/host/mrbgems/mruby-math/gem_init.o
CC    mrbgems/mruby-time/src/time.c -> build/host/mrbgems/mruby-time/src/time.o
CC    build/host/mrbgems/mruby-time/gem_init.c -> build/host/mrbgems/mruby-time/gem_init.o
CC    mrbgems/mruby-struct/src/struct.c -> build/host/mrbgems/mruby-struct/src/struct.o
      MRBC mrbgems/mruby-struct/mrblib/struct.rb 
CC    build/host/mrbgems/mruby-struct/gem_init.c -> build/host/mrbgems/mruby-struct/gem_init.o
CC    mrbgems/mruby-sprintf/src/kernel.c -> build/host/mrbgems/mruby-sprintf/src/kernel.o
CC    mrbgems/mruby-sprintf/src/sprintf.c -> build/host/mrbgems/mruby-sprintf/src/sprintf.o
CC    build/host/mrbgems/mruby-sprintf/gem_init.c -> build/host/mrbgems/mruby-sprintf/gem_init.o
CC    mrbgems/mruby-string-ext/src/string.c -> build/host/mrbgems/mruby-string-ext/src/string.o
      MRBC mrbgems/mruby-string-ext/mrblib/string.rb 
CC    build/host/mrbgems/mruby-string-ext/gem_init.c -> build/host/mrbgems/mruby-string-ext/gem_init.o
CC    mrbgems/mruby-numeric-ext/src/numeric_ext.c -> build/host/mrbgems/mruby-numeric-ext/src/numeric_ext.o
CC    build/host/mrbgems/mruby-numeric-ext/gem_init.c -> build/host/mrbgems/mruby-numeric-ext/gem_init.o
CC    build/host/mrbgems/gem_init.c -> build/host/mrbgems/gem_init.o
AR    build/host/lib/libmruby.a 
LD    build/host/bin/mruby 
CC    tools/mirb/mirb.c -> build/host/tools/mirb/mirb.o
LD    build/host/bin/mirb 

Build summary:

================================================
      Config Name: host
 Output Directory: build/host
         Binaries: mruby, mrbc, mirb
    Included Gems:
             mruby-math
             mruby-time
             mruby-struct
             mruby-sprintf
             mruby-string-ext
             mruby-numeric-ext
================================================

</textarea></td>
          <td><textarea>ar: creating /home/mruby/arm-nb6/mruby-mruby-9d0bbdb/build/host/lib/libmruby_core.a
ar: creating /home/mruby/arm-nb6/mruby-mruby-9d0bbdb/build/host/lib/libmruby.a
</textarea></td>
        </tr>
        <tr>
          <th>make test</th>
          <td><textarea>(in /home/mruby/arm-nb6/mruby-mruby-9d0bbdb)
CC    test/driver.c -> build/host/test/driver.o
GEN   *.rb -> build/host/test/mrbtest.c
      MRBC test/assert.rb 
      MRBC test/t/module.rb 
      MRBC test/t/kernel.rb 
      MRBC test/t/integer.rb 
      MRBC test/t/gc.rb 
      MRBC test/t/standarderror.rb 
      MRBC test/t/basicobject.rb 
      MRBC test/t/object.rb 
      MRBC test/t/hash.rb 
      MRBC test/t/comparable.rb 
      MRBC test/t/exception.rb 
      MRBC test/t/numeric.rb 
      MRBC test/t/bs_literal.rb 
      MRBC test/t/false.rb 
      MRBC test/t/float.rb 
      MRBC test/t/class.rb 
      MRBC test/t/nomethoderror.rb 
      MRBC test/t/true.rb 
      MRBC test/t/nil.rb 
      MRBC test/t/rangeerror.rb 
      MRBC test/t/typeerror.rb 
      MRBC test/t/proc.rb 
      MRBC test/t/literals.rb 
      MRBC test/t/indexerror.rb 
      MRBC test/t/nameerror.rb 
      MRBC test/t/bs_block.rb 
      MRBC test/t/regexperror.rb 
      MRBC test/t/string.rb 
      MRBC test/t/argumenterror.rb 
      MRBC test/t/runtimeerror.rb 
      MRBC test/t/array.rb 
      MRBC test/t/range.rb 
      MRBC test/t/syntax.rb 
      MRBC test/t/localjumperror.rb 
      MRBC test/t/symbol.rb 
      MRBC test/t/enumerable.rb 
CC    build/host/test/mrbtest.c -> build/host/test/mrbtest.o
      MRBC test/assert.rb 
      MRBC mrbgems/mruby-math/test/math.rb 
CC    build/host/mrbgems/mruby-math/gem_test.c -> build/host/mrbgems/mruby-math/gem_test.o
      MRBC test/assert.rb 
      MRBC mrbgems/mruby-time/test/time.rb 
CC    build/host/mrbgems/mruby-time/gem_test.c -> build/host/mrbgems/mruby-time/gem_test.o
      MRBC test/assert.rb 
      MRBC mrbgems/mruby-struct/test/struct.rb 
CC    build/host/mrbgems/mruby-struct/gem_test.c -> build/host/mrbgems/mruby-struct/gem_test.o
      MRBC test/assert.rb 
      MRBC mrbgems/mruby-sprintf/test/sprintf.rb 
CC    build/host/mrbgems/mruby-sprintf/gem_test.c -> build/host/mrbgems/mruby-sprintf/gem_test.o
      MRBC test/assert.rb 
      MRBC mrbgems/mruby-string-ext/test/string.rb 
CC    build/host/mrbgems/mruby-string-ext/gem_test.c -> build/host/mrbgems/mruby-string-ext/gem_test.o
      MRBC test/assert.rb 
      MRBC mrbgems/mruby-numeric-ext/test/numeric.rb 
CC    build/host/mrbgems/mruby-numeric-ext/gem_test.c -> build/host/mrbgems/mruby-numeric-ext/gem_test.o
AR    build/host/test/mrbtest.a 
LD    build/host/test/mrbtest 
>>> Test host <<<
mrbtest - Embeddable Ruby Test

This is a very early version, please test and report errors.
Thanks :)

.....................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................
Total: 533
   OK: 533
   KO: 0
Crash: 0
 Time: 9.366121 seconds

</textarea></td>
          <td><textarea>ar: creating /home/mruby/arm-nb6/mruby-mruby-9d0bbdb/build/host/test/mrbtest.a
</textarea></td>
        </tr>
        
      </table>
    

    <h2><a name="commitlog">commit log</a> <span style="font-size:small;"><a href="#top">#top</a></span></h2>
      <pre>commit 9d0bbdb7f8b54631d639d3ed3038b6546ee4558d
Author: Yukihiro Matz Matsumoto &lt;matz@ruby-lang.org&gt;
Date:   Thu Mar 14 19:33:38 2013 +0900

    use size_t for string length C API

diff --git a/include/mruby.h b/include/mruby.h
index 6d7be76..018a6a6 100644
--- a/include/mruby.h
+++ b/include/mruby.h
@@ -202,7 +202,7 @@ void *mrb_realloc(mrb_state*, void*, size_t);
 struct RBasic *mrb_obj_alloc(mrb_state*, enum mrb_vtype, struct RClass*);
 void *mrb_free(mrb_state*, void*);
 
-mrb_value mrb_str_new(mrb_state *mrb, const char *p, int len); /* mrb_str_new */
+mrb_value mrb_str_new(mrb_state *mrb, const char *p, size_t len);
 mrb_value mrb_str_new_cstr(mrb_state*, const char*);
 
 mrb_state* mrb_open(void);
diff --git a/include/mruby/string.h b/include/mruby/string.h
index 2fc7484..613c6c6 100644
--- a/include/mruby/string.h
+++ b/include/mruby/string.h
@@ -46,10 +46,10 @@ mrb_value mrb_str_plus(mrb_state*, mrb_value, mrb_value);
 mrb_value mrb_obj_as_string(mrb_state *mrb, mrb_value obj);
 mrb_value mrb_str_resize(mrb_state *mrb, mrb_value str, int len); /* mrb_str_resize */
 mrb_value mrb_string_value(mrb_state *mrb, mrb_value *ptr); /* StringValue */
-mrb_value mrb_str_substr(mrb_state *mrb, mrb_value str, mrb_int beg, int len);
+mrb_value mrb_str_substr(mrb_state *mrb, mrb_value str, mrb_int beg, mrb_int len);
 mrb_value mrb_check_string_type(mrb_state *mrb, mrb_value str);
 mrb_value mrb_str_buf_new(mrb_state *mrb, int capa);
-mrb_value mrb_str_buf_cat(mrb_state *mrb, mrb_value str, const char *ptr, int len);
+mrb_value mrb_str_buf_cat(mrb_state *mrb, mrb_value str, const char *ptr, size_t len);
 
 char *mrb_string_value_cstr(mrb_state *mrb, mrb_value *ptr);
 char *mrb_string_value_ptr(mrb_state *mrb, mrb_value ptr);
diff --git a/mrbgems/mruby-struct/src/struct.c b/mrbgems/mruby-struct/src/struct.c
index 884d4cd..5446c6f 100644
--- a/mrbgems/mruby-struct/src/struct.c
+++ b/mrbgems/mruby-struct/src/struct.c
@@ -166,7 +166,7 @@ mrb_id_attrset(mrb_state *mrb, mrb_sym id)
 {
   const char *name;
   char *buf;
-  int len;
+  size_t len;
   mrb_sym mid;
 
   name = mrb_sym2name_len(mrb, id, &amp;len);
@@ -184,7 +184,8 @@ static mrb_value
 mrb_struct_set(mrb_state *mrb, mrb_value obj, mrb_value val)
 {
   const char *name;
-  int i, len;
+  int i;
+  size_t len;
   mrb_sym mid;
   mrb_value members, slot, *ptr, *ptr_members;
 
@@ -471,7 +472,7 @@ inspect_struct(mrb_state *mrb, mrb_value s, int recur)
     id = mrb_symbol(slot);
     if (mrb_is_local_id(id) || mrb_is_const_id(id)) {
       const char *name;
-      int len;
+      size_t len;
 
       name = mrb_sym2name_len(mrb, id, &amp;len);
       mrb_str_append(mrb, str, mrb_str_new(mrb, name, len));
diff --git a/src/parse.y b/src/parse.y
index c4b83bb..fe1bd80 100644
--- a/src/parse.y
+++ b/src/parse.y
@@ -882,7 +882,7 @@ heredoc_start_sym(parser_state *p, node *beg, mrb_sym sym, enum heredoc_type typ
 {
   char *bs = (char*)beg-&gt;cdr-&gt;car;
   int allow_indent = (bs[2] == '-');
-  int len;
+  size_t len;
   const char *s = mrb_sym2name_len(p-&gt;mrb, sym, &amp;len);
   return heredoc_start_sb(p, s, len, type, allow_indent);
 }
diff --git a/src/string.c b/src/string.c
index 89bcf0c..cd70e63 100644
--- a/src/string.c
+++ b/src/string.c
@@ -167,7 +167,7 @@ mrb_str_buf_new(mrb_state *mrb, int capa)
 }
 
 static void
-str_buf_cat(mrb_state *mrb, struct RString *s, const char *ptr, mrb_int len)
+str_buf_cat(mrb_state *mrb, struct RString *s, const char *ptr, size_t len)
 {
   mrb_int capa;
   mrb_int total;
@@ -202,7 +202,7 @@ str_buf_cat(mrb_state *mrb, struct RString *s, const char *ptr, mrb_int len)
 }
 
 mrb_value
-mrb_str_buf_cat(mrb_state *mrb, mrb_value str, const char *ptr, mrb_int len)
+mrb_str_buf_cat(mrb_state *mrb, mrb_value str, const char *ptr, size_t len)
 {
   if (len == 0) return str;
   str_buf_cat(mrb, mrb_str_ptr(str), ptr, len);
@@ -210,14 +210,10 @@ mrb_str_buf_cat(mrb_state *mrb, mrb_value str, const char *ptr, mrb_int len)
 }
 
 mrb_value
-mrb_str_new(mrb_state *mrb, const char *p, mrb_int len)
+mrb_str_new(mrb_state *mrb, const char *p, size_t len)
 {
   struct RString *s;
 
-  if (len &lt; 0) {
-    len = 0;
-  }
-
   s = str_new(mrb, p, len);
   return mrb_obj_value(s);
 }
@@ -237,8 +233,8 @@ mrb_str_new_cstr(mrb_state *mrb, const char *p)
 
   if (p) {
     len = strlen(p);
-    if (len &gt; MRB_INT_MAX) {
-      len = MRB_INT_MAX;
+    if ((mrb_int)len &lt; 0) {
+      mrb_raise(mrb, E_ARGUMENT_ERROR, &quot;argument too big&quot;);
     }
   }
   else {
@@ -2550,14 +2546,7 @@ mrb_str_cat(mrb_state *mrb, mrb_value str, const char *ptr, mrb_int len)
 mrb_value
 mrb_str_cat2(mrb_state *mrb, mrb_value str, const char *ptr)
 {
-  size_t len;
-
-  len = strlen(ptr);
-  if (len &gt; MRB_INT_MAX) {
-    len = MRB_INT_MAX;
-  }
-
-  return mrb_str_cat(mrb, str, ptr, len);
+  return mrb_str_cat(mrb, str, ptr, strlen(ptr));
 }
 
 mrb_value
</pre>

  </body>
</html>
